---
tags: sql3

picture: https://docs.google.com/presentation/d/1nxGU_LttsJqo_g1HEFDTW8pcF7GnBjPUJOtyMpqwFio/edit#slide=id.gadd74da15c_0_123

ppt: https://drive.google.com/file/d/1K28qaBH_rWhNIH987Dhjq8VkJgNmr36O/view?usp=sharing
---

# 01. 顯示訂單價格超過 180 的訂單資料

綜合練習：

1. 進入 WinCP 將 customer.csv、orderlist.csv、product.csv 三個檔，複製到家目錄
2.啟動 PuTTY 進入 Linux
3.進入 sqlite3 同時 建立 bigdata 資料庫

>>>>>>>>>

顯示訂單價格超過 180 的
訂單編號(Order ID)
訂單日期(Order Date)
客戶姓名(Customer Name)
產品名稱(Product Name)
產品單價(Price)
將其輸出成 data04.csv
Cat 其內容

sqlite> .mode csv
sqlite> .import customer.csv customer
sqlite> SELECT * FROM customer;
CG-12520,"Claire Gute",Consumer,"United States",Henderson,Kentucky,42420,South
DV-13045,"Darrin Van Huff",Corporate,"United States","Los Angeles",California,90036,West
SO-20335,"Sean O'Donnell",Consumer,"United States","Fort Lauderdale",Florida,33311,South
BH-11710,"Brosina Hoffman",Consumer,"United States","Los Angeles",California,90032,West
...

sqlite> .import orderlist.csv orderlist
sqlite> .import product.csv product
sqlite> .header on
sqlite> .mode list
sqlite> SELECT * FROM customer;
Customer ID|Customer Name|Segment|Country|City|State|Postal Code|Region
CG-12520|Claire Gute|Consumer|United States|Henderson|Kentucky|42420|South
DV-13045|Darrin Van Huff|Corporate|United States|Los Angeles|California|90036|West
SO-20335|Sean O'Donnell|Consumer|United States|Fort Lauderdale|Florida|33311|South
...

sqlite> .schema customer
CREATE TABLE customer(
  "Customer ID" TEXT,
  "Customer Name" TEXT,
  "Segment" TEXT,
  "Country" TEXT,
  "City" TEXT,
  "State" TEXT,
  "Postal Code" TEXT,
  "Region" TEXT
);
sqlite> .schema orderlist
CREATE TABLE orderlist(
  "Order ID" TEXT,
  "Order Date" TEXT,
  "Ship Date" TEXT,
  "Ship Mode" TEXT,
  "Customer ID" TEXT,
  "Product ID" TEXT
);
sqlite> .schema product
CREATE TABLE product(
  "Product ID" TEXT,
  "Category" TEXT,
  "Sub-Category" TEXT,
  "Product Name" TEXT,
  "Price" TEXT
);


CREATE TABLE product1(
	"Product ID" TEXT,
	"Category" TEXT,
	"Sub-Category" TEXT, 
	"Product Name" TEXT,
	"Price" integer);

INSERT INTO product1 ("Product ID" ,"Category","Sub-Category","Product Name","Price") SELECT
"Product ID" ,"Category","Sub-Category","Product Name","Price" FROM product;

SELECT * FROM product1;
Product ID|Category|Sub-Category|Product Name|Price
FUR-BO-10001798|Furniture|Bookcases|Bush Somerset Collection Bookcase|10
FUR-CH-10000454|Furniture|Chairs|Hon Deluxe Fabric Upholstered Stacking Chairs, Rounded Back|20
OFF-LA-10000240|Office Supplies|Labels|Self-Adhesive Address Labels for Typewriters by Universal|30
FUR-TA-10000577|Furniture|Tables|Bretford CR4500 Series Slim Rectangular Table|40
...

SELECT orderlist."Order ID", orderlist."Order Date",
customer."Customer Name", 
product1."Product Name", product1."Price" FROM 
orderlist INNER JOIN customer ON 
orderlist."Customer ID"=customer."Customer ID" INNER JOIN product1 ON 
product1."Product ID"=orderlist."Product ID" WHERE product1."Price" > 180;

sqlite> .mode column
sqlite> SELECT orderlist."Order ID", orderlist."Order Date",
   ...> customer."Customer Name", 
   ...> product1."Product Name", product1."Price" FROM 
   ...> orderlist INNER JOIN customer ON 
   ...> orderlist."Customer ID"=customer."Customer ID" INNER JOIN product1 ON 
   ...> product1."Product ID"=orderlist."Product ID" WHERE product1."Price" > 180;
Order ID        Order Date  Customer Name       Product Name  Price     
--------------  ----------  ------------------  ------------  ----------
CA-2011-143336  2011/8/27   Zuschuss Donatelli  Newell 341    190       
CA-2011-143336  2011/8/27   Zuschuss Donatelli  Cisco SPA 50  200       
CA-2011-143336  2011/8/27   Zuschuss Donatelli  Wilson Jones  210       
CA-2013-137330  2013/12/10  Ken Black           Newell 318    220       
CA-2013-137330  2013/12/10  Ken Black           Acco Six-Out  230       
US-2014-156909  2014/7/17   Sandra Flanagan     Global Delux  240  

sqlite> .mode csv
sqlite> .output data04.csv
sqlite> SELECT orderlist."Order ID", orderlist."Order Date",
   ...> customer."Customer Name", 
   ...> product1."Product Name", product1."Price" FROM 
   ...> orderlist INNER JOIN customer ON 
   ...> orderlist."Customer ID"=customer."Customer ID" INNER JOIN product1 ON 
   ...> product1."Product ID"=orderlist."Product ID" WHERE product1."Price" > 180;


bigred@cvn71:~/sql$ cat data04.csv 
"Order ID","Order Date","Customer Name","Product Name",Price
CA-2011-143336,2011/8/27,"Zuschuss Donatelli","Newell 341",190
CA-2011-143336,2011/8/27,"Zuschuss Donatelli","Cisco SPA 501G IP Phone",200
CA-2011-143336,2011/8/27,"Zuschuss Donatelli","Wilson Jones Hanging View Binder, White, 1""",210
CA-2013-137330,2013/12/10,"Ken Black","Newell 318",220
CA-2013-137330,2013/12/10,"Ken Black","Acco Six-Outlet Power Strip, 4' Cord Length",230
US-2014-156909,2014/7/17,"Sandra Flanagan","Global Deluxe Stacking Chair, Gray",240
















